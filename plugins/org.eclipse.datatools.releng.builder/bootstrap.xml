<project name="bootstrap" default="nodefault">

    <property environment="env" />
    <property name="WORKSPACE" location="${env.WORKSPACE}" />
    <property name="tmpDir" location="${WORKSPACE}/dependencyPkgs" />
    <property name="archiveBasePath" location="/home/data/httpd/download.eclipse.org/datatools/archives/dependencyPkgs" />

    <property name="eclipse.sdk.name" value="eclipse-SDK-4.2.2-linux-gtk.tar.gz"/>
    <property name="eclipse.sdk.file" value="${archiveBasePath}/platform/R-4.2.2-201302041200/${eclipse.sdk.name}"/>

    <property name="emf.name" value="emf-xsd-SDK-2.8.3.zip"/>
    <property name="emf.file" value="${archiveBasePath}/modeling/emf/2.8.3/R201301250826/${emf.name}"/>

    <property name="gef.name" value="GEF-SDK-3.8.2.zip"/>
    <property name="gef.file" value="${archiveBasePath}/tools/gef/3.8.2/R201301141834/${gef.name}"/>

    <property name="javahome_15" value="/shared/common/jdk-1.5.0_16"/>
    <property name="javahome_16" value="/shared/common/sun-jdk1.6.0_21_i586"/>

    <property file="${WORKSPACE}/build.properties"/>

 
    <target name="nodefault">
    </target>

    <target name="prepareDependency">
        <antcall target="installDependencies"/>
    </target>
    <target name="installDependencies">
	<mkdir dir="${tmpDir}" />

        <!-- install Eclipse Platform SDK -->
	<copy file="${eclipse.sdk.file}" todir="${tmpDir}" verbose="true" preservelastmodified="true" />
        <exec executable="tar" dir="${WORKSPACE}">
             <arg value="-xzf"/>
             <arg value="${tmpDir}/${eclipse.sdk.name}"/>
             <arg value="-C"/>
             <arg value="${WORKSPACE}"/>
        </exec>

        <!-- install EMF SDK -->
	<copy file="${emf.file}" todir="${tmpDir}" verbose="true" preservelastmodified="true" />
        <exec executable="unzip" dir="${WORKSPACE}">
             <arg value="-oq"/>
             <arg value="${tmpDir}/${emf.name}"/>
        </exec>

        <!-- install GEF SDK -->
	<copy file="${gef.file}" todir="${tmpDir}" verbose="true" preservelastmodified="true" />
        <exec executable="unzip" dir="${WORKSPACE}">
             <arg value="-oq"/>
             <arg value="${tmpDir}/${gef.name}"/>
        </exec>
    </target>

    <tstamp>
        <format property="buildTimestamp" pattern="yyyyMMdd-HHmm" /> 
        <format property="buildTimestamp2" pattern="yyyyMMddHHmm" /> 
        <format property="builddate" pattern="yyyyMMdd" /> 
    </tstamp>

    <target name="run">
	<property name="BranchName" value="master" />
        <ant antfile="buildAll.xml">
	    <property name="postingDirectory" value="${WORKSPACE}/output" />
	    <property name="buildDirectory" value="${WORKSPACE}/src" />
	    <property name="baseLocation" value="${WORKSPACE}/eclipse" />
	    <property name="basebuilder" value="${WORKSPACE}/eclipse.platform.releng.basebuilder" />
	    <property name="buildType" value="${buildType}" />
	    <property name="mapVersionTag" value="${BranchName}" />
	    <property name="BranchVersion" value="1.12.0" />
	    <property name="mapGitRoot" value="git://git.eclipse.org/gitroot/datatools" />
	    <property name="buildId" value="v${buildTimestamp}" />
	    <property name="buildid" value="v${buildTimestamp}" />
	    <property name="buildLabel" value="v${buildTimestamp}" />
	    <property name="timestamp" value="${buildTimestamp2}" />
	    <property name="build.date" value="${builddate}" />
	    <property name="logExtension" value=".xml" />
	    <property name="groupConfiguration" value="true" />
	    <property name="javacVerbose" value="true" />
	    <property name="javacFailOnError" value="true" />
	    <property name="hostname.sign" value="build.eclipse.org" />
	    <property name="sign.dir" value="/home/data/httpd/download-staging.priv/birt" />
	    <property name="home.dir" value="/home/data/users/${gitUser}" />
	    <property name="updateSite" value="${WORKSPACE}/updatesite" />
            <property name="J2SE-1.5" value="${javahome_15}/jre/lib/rt.jar:${javahome_15}/jre/lib/jsse.jar:${javahome_15}/jre/lib/jce.jar"/>
            <property name="JavaSE-1.6" value="${javahome_16}/jre/lib/rt.jar:${javahome_16}/jre/lib/jsse.jar:${javahome_16}/jre/lib/jce.jar"/>
            <property name="mapTag.properties" value="${WORKSPACE}/org.eclipse.datatools.releng.builder/mapTag.properties"/>
            <property name="package.version" value="1.12.0M6-${buildTimestamp2}"/>
            <property name="eclipse.pdebuild.scripts" value="${WORKSPACE}/eclipse.platform.releng.basebuilder/plugins/org.eclipse.pde.build_3.8.0.v20120119-1950/scripts"/>
            <property name="eclipse.pdebuild.templates" value="${WORKSPACE}/eclipse.platform.releng.basebuilder/plugins/org.eclipse.pde.build_3.8.0.v20120119-1950/templates"/>
            <property name="eclipse.pdebuild.home" value="${WORKSPACE}/eclipse.platform.releng.basebuilder"/>

	</ant>
    </target>
       
	
</project>
